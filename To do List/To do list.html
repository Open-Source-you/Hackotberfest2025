<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>To-Do List</title>

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #dfe9f3 0%, #ffffff 100%);
      min-height: 100vh;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #333;
    }

    .todo-container {
      width: 420px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      padding: 25px 30px;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }

    h2 {
      text-align: center;
      font-weight: 600;
      margin-bottom: 18px;
      color: #2c3e50;
    }

    .input-field {
      display: flex;
      margin-bottom: 15px;
    }

    .input-field input {
      flex: 1;
      padding: 10px 12px;
      font-size: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      outline: none;
      transition: 0.3s;
    }

    .input-field input:focus {
      border-color: #007bff;
      box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
    }

    .input-field button {
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      margin-left: 6px;
      padding: 10px 16px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .input-field button:hover {
      background-color: #0056b3;
    }

    .control-buttons {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      gap: 6px;
    }

    .control-buttons button {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      color: white;
      transition: 0.3s;
    }

    #selectAllBtn {
      background-color: #17a2b8;
    }

    #selectAllBtn:hover {
      background-color: #138496;
    }

    #deleteSelected {
      background-color: #dc3545;
    }

    #deleteSelected:hover {
      background-color: #c82333;
    }

    ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
      max-height: 350px;
      overflow-y: auto;
    }

    li {
      background: #f8f9fa;
      margin-bottom: 10px;
      padding: 10px 12px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: 0.2s;
    }

    li:hover {
      background: #e9ecef;
    }

    li.completed .task-text {
      text-decoration: line-through;
      color: gray;
    }

    .task-left {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      flex: 1;
    }

    .task-details {
      display: flex;
      flex-direction: column;
    }

    .task-text {
      font-weight: 500;
      word-break: break-word;
    }

    .timestamp {
      font-size: 12px;
      color: #777;
    }

    .delete-btn {
      background: transparent;
      color: #dc3545;
      border: none;
      cursor: pointer;
      font-size: 18px;
      padding: 5px;
      border-radius: 4px;
      transition: color 0.3s ease, background-color 0.3s ease;
    }

    .delete-btn:hover {
      background-color: #f8d7da;
    }

    .no-tasks {
      text-align: center;
      color: #777;
      font-style: italic;
      margin-top: 10px;
    }

    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 3px;
    }

    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>
</head>

<body>
  <div class="todo-container">
    <h2>To-Do List 🧠</h2>

    <form id="taskForm" class="input-field">
      <input 
        id="taskInput" 
        type="text" 
        placeholder="Enter your task..." 
        aria-label="Enter new task"
        required
      />
      <button type="submit" id="addTaskButton">Add</button>
    </form>

    <div class="control-buttons">
      <button id="selectAllBtn" type="button">Select All</button>
      <button id="deleteSelected" type="button">Delete Selected</button>
    </div>

    <ul id="taskList" aria-label="Task list"></ul>
    <p id="noTasks" class="no-tasks" style="display:none;">No tasks yet 🎯</p>
  </div>

  <script>
    // DOM Elements
    const taskForm = document.getElementById('taskForm');
    const selectAllBtn = document.getElementById('selectAllBtn');
    const deleteSelectedBtn = document.getElementById('deleteSelected');
    const taskInput = document.getElementById('taskInput');
    const taskList = document.getElementById('taskList');
    const noTasksMsg = document.getElementById('noTasks');

    // Initialize
    window.addEventListener('DOMContentLoaded', () => {
      renderTasks();
      taskInput.focus();
    });

    taskForm.addEventListener('submit', handleAddTask);
    selectAllBtn.addEventListener('click', toggleSelectAll);
    deleteSelectedBtn.addEventListener('click', deleteSelectedTasks);

    // Local Storage Helpers
    const getTasks = () => {
      try {
        return JSON.parse(localStorage.getItem('tasks')) || [];
      } catch {
        return [];
      }
    };

    const saveTasks = (tasks) => {
      localStorage.setItem('tasks', JSON.stringify(tasks));
    };

    // Add Task
    function handleAddTask(event) {
      event.preventDefault();
      const text = taskInput.value.trim();
      if (text === '') {
        alert('Please enter a task.');
        taskInput.focus();
        return;
      }

      const newTask = {
        id: Date.now(),
        text,
        selected: false,
        completed: false,
        timestamp: new Date().toLocaleString()
      };

      const tasks = getTasks();
      tasks.push(newTask);
      saveTasks(tasks);
      renderTasks();
      taskInput.value = '';
      taskInput.focus();
    }

    // Render Tasks
    function renderTasks() {
      const tasks = getTasks();
      taskList.innerHTML = '';
      noTasksMsg.style.display = tasks.length ? 'none' : 'block';

      tasks.forEach(task => {
        const li = document.createElement('li');
        if (task.completed) li.classList.add('completed');

        const taskLeft = document.createElement('div');
        taskLeft.classList.add('task-left');

        const checkboxWrapper = document.createElement('div');
        const checkboxId = `task-${task.id}`;
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = checkboxId;
        checkbox.checked = task.selected;

        checkbox.addEventListener('change', () => {
          task.selected = checkbox.checked;
          task.completed = checkbox.checked;
          saveTasks(tasks);
          renderTasks();
        });

        const label = document.createElement('label');
        label.htmlFor = checkboxId;
        label.classList.add('visually-hidden');
        label.textContent = `Select task: ${task.text}`;

        checkboxWrapper.appendChild(checkbox);
        checkboxWrapper.appendChild(label);

        const details = document.createElement('div');
        details.classList.add('task-details');

        const text = document.createElement('span');
        text.classList.add('task-text');
        text.textContent = task.text;

        const time = document.createElement('span');
        time.classList.add('timestamp');
        time.textContent = `Added: ${task.timestamp}`;

        details.appendChild(text);
        details.appendChild(time);

        taskLeft.appendChild(checkboxWrapper);
        taskLeft.appendChild(details);

        const deleteBtn = document.createElement('button');
        deleteBtn.type = 'button';
        deleteBtn.classList.add('delete-btn');
        deleteBtn.innerHTML = '🗑️';
        deleteBtn.setAttribute('aria-label', `Delete task: ${task.text}`);
        deleteBtn.addEventListener('click', () => {
          const updated = tasks.filter(t => t.id !== task.id);
          saveTasks(updated);
          renderTasks();
        });

        li.appendChild(taskLeft);
        li.appendChild(deleteBtn);
        taskList.appendChild(li);
      });

      updateSelectAllButtonText();
    }

    // Select/Deselect All
    function toggleSelectAll() {
      const tasks = getTasks();
      if (tasks.length === 0) return;

      const allSelected = tasks.every(t => t.selected);
      tasks.forEach(t => {
        t.selected = !allSelected;
        t.completed = !allSelected;
      });
      saveTasks(tasks);
      renderTasks();
    }

    // Delete Selected
    function deleteSelectedTasks() {
      const tasks = getTasks();
      const selectedTasks = tasks.filter(t => t.selected);

      if (selectedTasks.length === 0) {
        alert('No tasks selected for deletion.');
        return;
      }

      if (confirm(`Are you sure you want to delete ${selectedTasks.length} task(s)?`)) {
        const updatedTasks = tasks.filter(t => !t.selected);
        saveTasks(updatedTasks);
        renderTasks();
      }
    }

    // Update Select All Button Text
    function updateSelectAllButtonText() {
      const tasks = getTasks();
      if (tasks.length === 0) {
        selectAllBtn.textContent = 'Select All';
        return;
      }
      const allSelected = tasks.every(t => t.selected);
      selectAllBtn.textContent = allSelected ? 'Deselect All' : 'Select All';
    }
  </script>
</body>
</html>
